# UI仕様

## 全体レイアウト

2ペインレイアウトで、各ペインが縦に複数のボックスに分割されています。

### 基本レイアウト

```
╭─ Connection ✓ ─────────────╮╭─ Data ────────────────────────────────╮
│ localhost:8080             ││id name          email         age     │
╰────────────────────────────╯│── ──────────── ────────────── ────────│
╭─ Tables (7) ───────────────╮│ 1 Alice Smith  alice@...       28     │
│  users                     ││ 2 Bob Johnson  bob@...         35     │
│*  addresses                ││ 3 Charlie      charlie@...     42     │
│   phones                   ││ 4 Diana        diana@...       31     │
│  products                  ││ 5 Eve          eve@...         29     │
│  orders                    ││                                       │
╰────────────────────────────╯│                                       │
╭─ Schema (users) ───────────╮│                                       │
│ Columns:                   ││                                       │
│ P id     INTEGER           ││                                       │
│   name   STRING            ││                                       │
│   email  STRING            ││                                       │
│                            ││                                       │
│ Indexes:                   ││                                       │
│   email_idx  (email)       ││                                       │
╰────────────────────────────╯│                                       │
╭─ SQL ──────────────────────╮│                                       │
│ SELECT * FROM users        ││                                       │
╰────────────────────────────╯╰───────────────────────────────────────╯
Select: <enter>                                                  Dito
```

**レイアウト構成:**

**左ペイン（上から順に）:**
1. **Connection** - 接続情報と管理
2. **Tables** - テーブル一覧
3. **Schema** - 選択したテーブルのスキーマ情報
4. **SQL** - 実行中のSQLクエリ表示

**右ペイン:**
1. **Data** - データ表示（グリッドビュー/レコードビュー）

**フッター:**
- ヘルプテキスト（左寄せ）
- アプリ名「Dito」（右下）

## 各ペインの詳細

### 1. Connection（接続情報）

#### 未設定

```
╭─ Connection ───────────────╮
│ (not configured)           │
╰────────────────────────────╯
```

#### 未接続

```
╭─ Connection ───────────────╮
│ localhost:8080             │
╰────────────────────────────╯
```

#### 接続中

```
╭─ Connection ✓ ─────────────╮
│ localhost:8080             │
╰────────────────────────────╯
```
※ ✓ は緑色で表示

**機能:**
- 設定済みのエンドポイント情報を表示
- 接続中はタイトルに ✓（緑色）を表示
- `Enter` で接続設定ダイアログを開く
- `ctrl+d` で切断

### 2. Tables（テーブル一覧）

```
╭─ Tables (7) ───────────────╮
│  users                     │
│   addresses                │
│   phones                   │
│  products                  │
│   reviews                  │
│  orders                    │
│   items                    │
╰────────────────────────────╯
```
※ カーソル移動中の行は背景色（フルスパン）で表示

#### テーブル選択時

```
╭─ Tables (7) ───────────────╮
│  users                     │
│*  addresses                │
│   phones                   │
│  products                  │
│   reviews                  │
│  orders                    │
│   items                    │
╰────────────────────────────╯
```
※ 選択中の行は背景色（フルスパン）で表示、`*` は選択済み（データ表示中）のテーブル

**機能:**
- 接続中のデータベースのテーブル一覧をツリー形式で表示
- 子テーブルはインデントで表現
- 選択中のテーブルは背景色（フルスパン）で表示
- データ表示中のテーブルは行頭（左寄せ）に `*` でマーク
- `↑/↓` または `k/j` でテーブルを移動 → **Schemaペインが自動更新**
- `Enter` で選択 → **Dataペインが更新**（SQL、Dataペインが更新される）

### 3. Schema（スキーマ詳細）

```
╭─ Schema (users) ───────────╮
│ Columns:                   │
│ P id     INTEGER           │
│   name   STRING            │
│   email  STRING            │
│   age    INTEGER           │
│                            │
│ Indexes:                   │
│   email_idx  (email)       │
╰────────────────────────────╯
```

**機能:**
- Tables で選択したテーブルのスキーマ情報を表示
- **フォーカス不可**（情報表示専用ペイン）
- Tablesペインでの `↑/↓` 移動に応じて自動更新
- タイトルにテーブル名を表示
- セクションラベル（Columns、Indexes）はシアン色で表示
- カラム一覧（型、Primary Key表示）
- インデックス一覧

### 4. SQL（SQLクエリ表示）

#### 通常モード（テーブル選択時）

```
╭─ SQL ──────────────────────╮
│ SELECT * FROM users        │
╰────────────────────────────╯
```

#### カスタムSQLモード

```
╭─ SQL [Custom] ─────────────╮
│ SELECT * FROM users        │
│ WHERE age > 30             │
╰────────────────────────────╯
```

**機能:**
- 現在実行中/実行したSQLクエリを表示
- テーブル選択時は自動的に `SELECT * FROM テーブル名` を表示
- カスタムSQL実行時はタイトルに `[Custom]` を表示し、そのクエリを表示
- SQLペインにフォーカスして編集、`Ctrl+R` で実行
- Dataペインで `Esc` キーを押すとカスタムSQLモードを解除し、通常モードに戻る

### 5. Data（データ表示）

#### グリッドビュー

```
╭─ Data ────────────────────────────────────────────────────╮
│id name          email             age created_at          │
│── ──────────── ───────────────── ──── ────────────────────│
│ 1 Alice Smith  alice@example.com   28 2024-01-15T10:30:00 │
│ 2 Bob Johnson  bob@example.com     35 2024-01-16T14:20:00 │
│ 3 Charlie Bro… charlie@exampl…     42 2024-01-17T09:15:00 │
│ 4 Diana Princ… diana@example.c…    31 2024-01-18T16:45:00 │
│                                                           │
│                                                           │
╰───────────────────────────────────────────────────────────╯
```
※ 選択中の行は背景色（フルスパン）で表示
※ 数値型（INTEGER, DOUBLE等）のカラムは右寄せで表示

**機能:**
- グリッド形式でデータを表示
- 選択中の行は背景色（フルスパン）で表示
- 数値型のカラムはデータを右寄せで表示
- `↑/↓` または `k/j` で行選択
- `←/→` または `h/l` で横スクロール
- `Enter` でレコード詳細ダイアログを開く


## ペイン切り替え

```
Detail: <enter>                                                  Dito
```

**操作:**
- `tab` で次のペインへ移動、`shift+tab` で前のペインへ移動
- フォーカス可能なペイン: Connection → Tables → SQL → Data
- Schemaペインはフォーカス不可（情報表示専用、Tablesペインの選択に応じて自動更新）
- 各ペイン内では `↑/↓` または `k/j` で項目選択
- アクティブなペインはボーダー色が変わる（実装時）

## ダイアログ

**共通仕様:**
- ダイアログは画面中央に表示
- 必要最小限のサイズで表示
- 背景（メイン画面）はグレーアウトして表示される
- ダイアログにフォーカスがある状態で操作

### 接続設定ダイアログ

Connection ペインで `Enter` を押すと開く。

#### 接続種類選択

```
╭─ Connection Setup ─────────────────────────╮
│                                            │
│ * On-Premise                               │
│   Cloud (Oracle)                           │
│                                            │
╰────────────────────────────────────────────╯
Select: <enter> | Cancel: <esc>
```
※ 選択中の行は背景色（フルスパン）で表示、`*` は選択済みマーク

#### On-Premise設定（通常表示）

```
╭─ On-Premise Connection ────────────────────╮
│                                            │
│ * Endpoint:  localhost                     │
│   Port:      8080                          │
│   Secure:    [ ] HTTPS/TLS                 │
│                                            │
│   [Test Connection]  [Connect]             │
│                                            │
╰────────────────────────────────────────────╯
Navigate: tab/shift+tab | Toggle: <space> | Edit: <enter> | Cancel: <esc>
```
※ 選択中の行は背景色（フルスパン）で表示、`*` は選択済みマーク

#### On-Premise設定（編集中）

```
╭─ On-Premise Connection ────────────────────╮
│                                            │
│ * Endpoint:  localhost█                    │
│   Port:      8080                          │
│   Secure:    [ ] HTTPS/TLS                 │
│                                            │
│   [Test Connection]  [Connect]             │
│                                            │
╰────────────────────────────────────────────╯
Editing... | Confirm: <enter> | Cancel: <esc>
```
※ 選択中の行は背景色（フルスパン）で表示、`*` は選択済みマーク
※ █ はブロックカーソル（背景色で表示）

#### Cloud設定（TODO）

Cloud設定は将来実装予定です。

**操作:**
- `tab` / `shift+tab` でフィールド間を移動
- 選択中のフィールドは背景色（フルスパン）で表示、選択済みは行頭に `*` でマーク
- テキストフィールドで `Enter` を押すとインライン編集モードに入る
- 編集モード中は文字入力が可能、`Enter` で確定、`Esc` で編集キャンセル
- `Space` でチェックボックス/ラジオボタンをトグル
- ボタンで `Enter` を押すと実行
- `Esc` でダイアログをキャンセル（編集モード外）

### レコード詳細ダイアログ

Data ペイン（グリッドビュー）で `Enter` キーを押すと開く。

```
╭─ Record Detail (1 of 150) ─────────────────────────────╮
│                                                        │
│ id           1                                         │
│ name         Alice Smith                               │
│ email        alice@example.com                         │
│ age          28                                        │
│ created_at   2024-01-15T10:30:00.000Z                  │
│ phone        +1-555-0101                               │
│ address      123 Main St                               │
│                                                        │
╰────────────────────────────────────────────────────────╯
Navigate: ↑/↓ | Close: <esc>
```

**機能:**
- 選択した行の詳細を縦に表示
- 画面中央にダイアログで表示
- 背景（グリッドビュー）はグレーアウト
- `↑/↓` で次/前の行に切り替え
- `Esc` で閉じる

## キーバインディング一覧

### グローバル
- `tab` / `shift+tab` - ペイン切り替え
- `ctrl+c` - アプリケーション終了

### ペイン内共通
- `↑` / `↓` または `k` / `j` - 項目選択
- `Enter` - 決定/実行/開く

### Tables ペイン
- `↑/↓` または `k/j` - テーブル移動（Schemaペインが自動更新）
- `Enter` - テーブル選択（SQL、Dataペインが更新される）

### Data ペイン（グリッドビュー）
- `←` / `→` または `h` / `l` - 横スクロール
- `Enter` - レコード詳細ダイアログを開く
- `Esc` - （カスタムSQL実行後）デフォルトSQLに戻る

### Connection ペイン
- `Enter` - 接続設定ダイアログを開く
- `ctrl+d` - 切断

### ダイアログ（接続設定）
- `tab` / `shift+tab` - フィールド間を移動
- `<space>` - チェックボックス/ラジオボタンのトグル
- `<enter>` - テキストフィールド: インライン編集モードに入る / ボタン: 実行
- 編集モード中:
  - 文字入力可能
  - `<enter>` - 編集を確定
  - `<esc>` - 編集をキャンセル
- `<esc>` - ダイアログをキャンセル（編集モード外）

### ダイアログ（レコード詳細）
- `↑/↓` - 次/前のレコードに切り替え
- `<esc>` - 閉じる

### SQL ペイン
- SQLを編集して `ctrl+r` でカスタムSQL実行

## 配色・スタイル

- アクティブペインのボーダー: シアン色（`#00D9FF`）
- 非アクティブペインのボーダー: グレー（`#666666`）
- 選択中の項目: `*` マーカー（左寄せ）
- セクションラベル（Columns、Indexes）: シアン色（`#00D9FF`）
- 接続状態マーカー: ✓（緑色）
- ダイアログ背景（メイン画面）: グレーアウト表示
- ヘルプテキスト: グレー（`#888888`）
- アプリ名: 右下、グレー（`#888888`）
