# Requirements Specification

## はじめに

**dito（ディト）** は、Oracle NoSQL DatabaseのTUI（Text User Interface）クライアントアプリケーションです。
コマンドラインから直感的にデータベースを操作できるモダンなインターフェースを提供します。

## 対象エディション

- **Oracle NoSQL Database On-Premise** (オンプレミス/ローカル環境)

### TODO

- **Oracle NoSQL Cloud Service** (OCI上のマネージドサービス) への対応

## 技術スタック

- **言語**: Go
- **TUIフレームワーク**: Bubble Tea (charmbracelet/bubbletea)
- **スタイリング**: Lipgloss (charmbracelet/lipgloss)
- **Oracle NoSQL SDK**: oracle/nosql-go-sdk

## MVP（最小実用製品）スコープ

### Phase 1: 基本機能

最初のリリースでは以下の機能を実装します：

#### 1. 接続機能

- 起動時に接続情報を入力するインタラクティブなフォーム
- Cloud版の接続パラメータ：
  - Region
  - Compartment ID
  - 認証方法（OCI Config Profile等）
- On-Premise版の接続パラメータ：
  - Endpoint URL
  - ポート番号
- 接続テスト機能

#### 2. テーブル一覧表示

- 接続中のデータベースの全テーブルを一覧表示
- 表示情報：
  - テーブル名（必須）
  - ※将来的にレコード数、ストレージサイズ、スキーマ情報も追加予定
- テーブル一覧のナビゲーション（上下キーで選択）

#### 3. テーブルスキーマ表示

- 選択したテーブルのスキーマ情報を表示
- 表示情報：
  - カラム一覧（名前、型、PRIMARY KEY表示）
  - 親子テーブルの関係
  - インデックス一覧

#### 4. テーブルデータ表示

- テーブル内のデータを閲覧
- 機能：
  - PRIMARY KEYでソートされたデータ表示
  - 最大1000行を取得
  - 画面高さに応じた動的なビューポート表示
  - カラム幅の自動調整（データの最長幅とカラム名の長い方、最大24文字）
  - スクロール操作（j/k または ↑/↓）
  - データ取得エラー時のエラーメッセージ表示

## UI/UXデザイン

### デザインコンセプト

- カラフルな配色
- Unicode記号やボックス描画文字の活用
- グラデーション効果
- 視認性の高いハイライト

### レイアウト構成

**エディション選択・接続設定画面:**
```
╭── Dito ─────────────────────────────────────╮  ← Border Title
│                                             │  ← 空行
│  コンテンツエリア                             │
│                                             │
├─────────────────────────────────────────────┤  ← Separator
│  ステータスエリア                             │
├─────────────────────────────────────────────┤  ← Separator
│  ヘルプ・キーバインド                         │  ← Footer
╰─────────────────────────────────────────────╯
```

**テーブル一覧画面（2ペインレイアウト）:**
```
╭── Dito ─────────────────────────────────────╮  ← Border Title
│                 Connected to localhost:8080 │  ← Header (接続情報)
├──────────────┬──────────────────────────────┤  ← Separator
│ 左ペイン     │ 右ペイン                      │
│ テーブル一覧 │ テーブル詳細/データ表示       │
│              │                              │
├──────────────┴──────────────────────────────┤  ← Separator
│ ステータスエリア (テーブル名、行数など)      │
├─────────────────────────────────────────────┤  ← Separator
│ ヘルプ・キーバインド                         │  ← Footer
╰─────────────────────────────────────────────╯
```

### キーバインド

**共通:**
- `q`: アプリケーション終了

**スキーマビュー:**
- `j/k` (または `↑/↓`): テーブル選択の上下移動
- `o` (または `Enter`): グリッドビューに切り替え
- `u` (または `Esc`): 前の画面に戻る

**グリッドビュー:**
- `j/k` (または `↑/↓`): データ行のスクロール
- `h/l` (または `←/→`): カラムの左右スクロール
- `o` (または `Enter`): レコードビューに切り替え
- `u` (または `Esc`): スキーマビューに戻る

**レコードビュー:**
- `j/k` (または `↑/↓`): 次/前の行に切り替え
- `u` (または `Esc`): グリッドビューに戻る

### エラーハンドリング

- 画面下部のステータスバーにエラーメッセージを表示
- エラーは赤色で強調表示
- 接続エラー、APIエラー等を適切にハンドリング

## 非機能要件

### パフォーマンス

- テーブル一覧の取得は5秒以内に完了
- UI操作はレスポンシブ（100ms以内の反応）

### セキュリティ

- 認証情報はメモリ上でのみ保持（ファイルに保存しない）
- セキュアな接続（HTTPS/TLS）

### 互換性

- macOS, Linux, Windows対応
- ターミナル幅80文字以上を推奨

## 将来の機能拡張（フェーズ2以降）

以下の機能は将来のバージョンで実装予定：

- SQL編集〜実行機能
- データのCRUD操作
- 接続設定ファイルのサポート
- テーブル統計情報の表示
- エクスポート/インポート機能
- クエリ履歴

## 成功基準

- ユーザーが簡単にOracle NoSQL Databaseに接続できる
- テーブル一覧を視覚的にわかりやすく表示できる
- エラーが発生した場合、わかりやすいメッセージを表示できる
